<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="603.125px" preserveAspectRatio="none" style="width:1692px;height:603px;background:#FFFFFF;" version="1.1" viewBox="0 0 1692 603" width="1692.7083px" zoomAndPan="magnify"><defs/><g><rect fill="#F5F5F5" height="591.569" style="stroke:#181818;stroke-width:0.5208;" width="149.7014" x="648.9243" y="6.25"/><text fill="#000000" font-family="sans-serif" font-size="16.6667" font-weight="bold" lengthAdjust="spacing" textLength="138.737" x="652.0493" y="21.7204">FHIR-Directory</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="4.7145" x="790.7862" y="22.4574">&#160;</text><rect fill="#FFFFFF" height="453.5319" style="stroke:#181818;stroke-width:1.0417;" width="10.4167" x="215.2796" y="72.8353"/><rect fill="#FFFFFF" height="285.7585" style="stroke:#181818;stroke-width:1.0417;" width="10.4167" x="718.5666" y="240.6087"/><rect fill="#FFFFFF" height="72.88" style="stroke:#181818;stroke-width:1.0417;" width="10.4167" x="1596.5658" y="121.6187"/><rect fill="#FFFFFF" height="46.11" style="stroke:#181818;stroke-width:1.0417;" width="10.4167" x="1596.5658" y="374.4954"/><line style="stroke:#181818;stroke-width:0.5208;stroke-dasharray:5.0,5.0;" x1="219.7917" x2="219.7917" y1="62.4186" y2="545.1172"/><line style="stroke:#181818;stroke-width:0.5208;stroke-dasharray:5.0,5.0;" x1="722.9388" x2="722.9388" y1="62.4186" y2="545.1172"/><line style="stroke:#181818;stroke-width:0.5208;stroke-dasharray:5.0,5.0;" x1="1601.4887" x2="1601.4887" y1="62.4186" y2="545.1172"/><rect fill="#E3E3E3" height="31.5592" rx="2.6042" ry="2.6042" style="stroke:#181818;stroke-width:0.5208;" width="159.726" x="140.625" y="29.8177"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="145.1426" x="147.9167" y="50.646">TI-Messenger-Client</text><rect fill="#E3E3E3" height="31.5592" rx="2.6042" ry="2.6042" style="stroke:#181818;stroke-width:0.5208;" width="159.726" x="140.625" y="544.0755"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="145.1426" x="147.9167" y="564.9038">TI-Messenger-Client</text><rect fill="#E3E3E3" height="31.5592" rx="2.6042" ry="2.6042" style="stroke:#181818;stroke-width:0.5208;" width="107.9224" x="669.8138" y="29.8177"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="93.339" x="677.1055" y="50.646">Auth-Service</text><rect fill="#E3E3E3" height="31.5592" rx="2.6042" ry="2.6042" style="stroke:#181818;stroke-width:0.5208;" width="107.9224" x="669.8138" y="544.0755"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="93.339" x="677.1055" y="564.9038">Auth-Service</text><rect fill="#E3E3E3" height="48.5352" rx="2.6042" ry="2.6042" style="stroke:#181818;stroke-width:0.5208;" width="171.404" x="1516.0721" y="12.8418"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="156.8207" x="1523.3637" y="33.67">TI-Messenger-Service</text><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="125.4252" x="1539.0615" y="50.646">Messenger-Proxy</text><rect fill="#E3E3E3" height="48.5352" rx="2.6042" ry="2.6042" style="stroke:#181818;stroke-width:0.5208;" width="171.404" x="1516.0721" y="544.0755"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="156.8207" x="1523.3637" y="564.9038">TI-Messenger-Service</text><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="125.4252" x="1539.0615" y="581.8797">Messenger-Proxy</text><rect fill="#FFFFFF" height="453.5319" style="stroke:#181818;stroke-width:1.0417;" width="10.4167" x="215.2796" y="72.8353"/><rect fill="#FFFFFF" height="285.7585" style="stroke:#181818;stroke-width:1.0417;" width="10.4167" x="718.5666" y="240.6087"/><rect fill="#FFFFFF" height="72.88" style="stroke:#181818;stroke-width:1.0417;" width="10.4167" x="1596.5658" y="121.6187"/><rect fill="#FFFFFF" height="46.11" style="stroke:#181818;stroke-width:1.0417;" width="10.4167" x="1596.5658" y="374.4954"/><polygon fill="#181818" points="1584.0658,117.452,1594.4824,121.6187,1584.0658,125.7853,1588.2324,121.6187" style="stroke:#181818;stroke-width:1.0417;"/><line style="stroke:#181818;stroke-width:1.0417;" x1="225.6963" x2="1590.3158" y1="121.6187" y2="121.6187"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.2225" x="232.988" y="116.3417">[01]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="408.6105" x="268.3772" y="116.3417">POST /_matrix/client/v3/user/{userId}/openid/request_token</text><path d="M5.2083,78.0436 L5.2083,150.9603 L210.4167,150.9603 L210.4167,88.4603 L200,78.0436 L5.2083,78.0436 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5208;"/><path d="M200,78.0436 L200,88.4603 L210.4167,88.4603 L200,78.0436 " fill="#FAFAFA" style="stroke:#181818;stroke-width:0.5208;"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="89.2375" x="11.4583" y="95.8216">Precondition:</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="25.1856" x="11.4583" y="111.585">The</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="4.3045" x="36.644" y="111.585">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="29.5364" x="40.9485" y="111.585">user</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="4.3045" x="70.4849" y="111.585">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="10.8175" x="74.7894" y="111.585">is</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="4.3045" x="85.6069" y="111.585">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="46.166" x="89.9114" y="111.585">logged</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="4.3045" x="136.0774" y="111.585">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="12.3449" x="140.3819" y="111.585">in</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="4.3045" x="152.7267" y="111.585">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="10.5596" x="157.0313" y="111.585">&amp;</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="4.3045" x="167.5908" y="111.585">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="16.8676" x="171.8953" y="111.585">no</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="134.1471" x="11.4583" y="127.3483">search-accesstoken</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="4.3045" x="145.6055" y="127.3483">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="18.6198" x="149.91" y="127.3483">for</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="4.3045" x="168.5298" y="127.3483">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="22.2234" x="172.8343" y="127.3483">the</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="98.9705" x="11.4583" y="143.1117">FHIR-Directory</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="4.3045" x="110.4289" y="143.1117">&#160;</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="39.5274" x="114.7334" y="143.1117">exists</text><polygon fill="#181818" points="237.1546,190.332,226.738,194.4987,237.1546,198.6654,232.988,194.4987" style="stroke:#181818;stroke-width:1.0417;"/><line style="stroke:#181818;stroke-width:1.0417;stroke-dasharray:2.0,2.0;" x1="230.9046" x2="1600.7324" y1="194.4987" y2="194.4987"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.2225" x="243.4046" y="181.34">[02]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="518.2465" x="278.7938" y="173.4584">HTTP 200 OK, Result body {"access_token": "OFdZNozDIomXLrCWjgejIQBM"</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="356.5399" x="283.0983" y="189.2217">,..., "matrix_server_name": "matrix.service-ti.de",...}</text><polygon fill="#181818" points="706.0666,236.4421,716.4833,240.6087,706.0666,244.7754,710.2333,240.6087" style="stroke:#181818;stroke-width:1.0417;"/><line style="stroke:#181818;stroke-width:1.0417;" x1="225.6963" x2="712.3166" y1="240.6087" y2="240.6087"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.2225" x="232.988" y="227.4501">[03]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="340.1815" x="268.3772" y="219.5684">GET /tim-authenticate?mxId=matrix.service-ti.de"</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="402.2232" x="272.6817" y="235.3317">-H "X-Matrix-OpenID-Token: OFdZNozDIomXLrCWjgejIQBM"</text><line style="stroke:#181818;stroke-width:1.0417;" x1="728.9833" x2="772.7333" y1="286.7188" y2="286.7188"/><line style="stroke:#181818;stroke-width:1.0417;" x1="772.7333" x2="772.7333" y1="286.7188" y2="300.2604"/><line style="stroke:#181818;stroke-width:1.0417;" x1="730.025" x2="772.7333" y1="300.2604" y2="300.2604"/><polygon fill="#181818" points="740.4416,296.0938,730.025,300.2604,740.4416,304.4271,736.275,300.2604" style="stroke:#181818;stroke-width:1.0417;"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.2225" x="736.275" y="273.5601">[04]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="340.2013" x="771.6642" y="265.6784">Check that matrix server url "matrix.service-ti.de"</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="185.1069" x="775.9687" y="281.4418">is part of the federation list</text><line style="stroke:#181818;stroke-width:1.0417;" x1="728.9833" x2="772.7333" y1="330.6071" y2="330.6071"/><line style="stroke:#181818;stroke-width:1.0417;" x1="772.7333" x2="772.7333" y1="330.6071" y2="344.1488"/><line style="stroke:#181818;stroke-width:1.0417;" x1="730.025" x2="772.7333" y1="344.1488" y2="344.1488"/><polygon fill="#181818" points="740.4416,339.9821,730.025,344.1488,740.4416,348.3154,736.275,344.1488" style="stroke:#181818;stroke-width:1.0417;"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.2225" x="736.275" y="325.3301">[05]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="268.5125" x="771.6642" y="325.3301">lookup PORT for given matrix server url</text><polygon fill="#181818" points="1584.0658,370.3288,1594.4824,374.4954,1584.0658,378.6621,1588.2324,374.4954" style="stroke:#181818;stroke-width:1.0417;"/><line style="stroke:#181818;stroke-width:1.0417;" x1="728.9833" x2="1590.3158" y1="374.4954" y2="374.4954"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.2225" x="736.275" y="369.2184">[06]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="795.6787" x="771.6642" y="369.2184">GET matrix.service-ti.de:{PORT}/_matrix/federation/v1/openid/userinfo?access_token=OFdZNozDIomXLrCWjgejIQBM</text><polygon fill="#181818" points="740.4416,416.4388,730.025,420.6055,740.4416,424.7721,736.275,420.6055" style="stroke:#181818;stroke-width:1.0417;"/><line style="stroke:#181818;stroke-width:1.0417;stroke-dasharray:2.0,2.0;" x1="734.1916" x2="1600.7324" y1="420.6055" y2="420.6055"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.2225" x="746.6916" y="407.4468">[07]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="88.887" x="782.0808" y="399.5651">HTTP 200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="366.2796" x="782.0808" y="415.3285">Result Body {"sub": "@testuser:matrix.service-ti.de"}</text><line style="stroke:#181818;stroke-width:1.0417;" x1="728.9833" x2="772.7333" y1="450.9521" y2="450.9521"/><line style="stroke:#181818;stroke-width:1.0417;" x1="772.7333" x2="772.7333" y1="450.9521" y2="464.4938"/><line style="stroke:#181818;stroke-width:1.0417;" x1="730.025" x2="772.7333" y1="464.4938" y2="464.4938"/><polygon fill="#181818" points="740.4416,460.3271,730.025,464.4938,740.4416,468.6605,736.275,464.4938" style="stroke:#181818;stroke-width:1.0417;"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.2225" x="736.275" y="445.6752">[08]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="345.7489" x="771.6642" y="445.6752">Create search-accesstoken for TI-Messenger-Client</text><polygon fill="#181818" points="231.9463,522.2005,221.5296,526.3672,231.9463,530.5339,227.7796,526.3672" style="stroke:#181818;stroke-width:1.0417;"/><line style="stroke:#181818;stroke-width:1.0417;stroke-dasharray:2.0,2.0;" x1="225.6963" x2="722.7333" y1="526.3672" y2="526.3672"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.2225" x="238.1963" y="505.3268">[09]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="177.741" x="273.5855" y="489.5635">HTTP 200 OK, Result body</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="415.7583" x="273.5855" y="505.3268">{"access_token"="eyJ0eXAiOiJKV1...", "token_type":"bearer",</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="137.4863" x="273.5855" y="521.0902">"expires_in":86400}</text><!--SRC=[XPHlRzem4CRVvrESF6bzGmXiKpL5BLt_h2ljEbYBHhKn8PCSn2EnCzj1qAhVVUU45cX1UuEKS-wUny_zWfaAcNFDCuXp0Sr6mpFFbRxcUL_4De5t6_LCIHKbMcK8LXVeyS8gMMGZrC0EHgrVZSPlvdbxLjWKWPrVj6_yCw4niaelQd2BVmkKzx7W4pVC8DTH0bPDKGBEeuJB2Uvvf6H5978kBKGfS0Eir_QlqHYaS-sVfWAbPTv8pU70Y7iCc_kjJQc3mDLRyAQV28kt6Ibu0Ek3UL4EFYviuj-Ydea8cOSo1fgwuI0nhnqi6mPoLUfgDLymZqTMpBX5CkwHTxz5_I5qExSz28OPjrhCWwZq7ypU1uL17JouttRy6AWSfOW3xK8oTbZ6uab5mr8SMwzBTrCo5bOe6OBNIn1S9mW3gPfCC0OXuIr8jSpLvr54zgfqnqg3fOxDc2XqOQmfx-s4LlOJuz75VV8VfI5Sz7fT1m9qhcfmWwP8BUKKB-21LIALMHO2wvp7Fx-f-xEsokw-wjF-dmd-QNy_kMOma52hr-irO5KEGp8_GpsKF4FNMLNhfihMjw8U8tCTZrwCwyQgN7aHmfVF5AiLcKyO9fIfYEYLespUZW-tJdCU_0jWT_vrUUntAFBscTzpxaFOwNsL2oy8-IVvqmIZASNABLHoK5q92ftkk0yPe7qvla2DousCCKRDtL8XfMMiZK-LcXOvmNFJA_St4JFQv2kbPOVZpEMnJJPyS4CUdmbSQGQpvXDt3YOXn-feVQM7kpBPXeeplORAG2vHEQbGCSN8xVcJ9RgTMBWrePVRNejRewlje7lBNqJP-n-41_85muSC5vSDl3iM7N5vzQD9039YjZmSsaLEhB8HMK3DQWF9S9xJrsI6WkZ_kF-XqTZmJxYiFKNfFm00]--></g></svg>