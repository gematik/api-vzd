<?plantuml 1.2026.0?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" data-diagram-type="SEQUENCE" height="776px" preserveAspectRatio="none" style="width:1021px;height:776px;background:#FFFFFF;" version="1.1" viewBox="0 0 1021 776" width="1021px" zoomAndPan="magnify"><title>FHIR-VZD Authentisierung f&#252;r Fachdienste</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="337.251" x="338.0103" y="27.9951">FHIR-VZD Authentisierung f&#252;r Fachdienste</text><rect fill="#DDDDDD" height="727.0547" style="stroke:#181818;stroke-width:0.5;" width="125.8438" x="2.2021" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="119.8438" x="5.2021" y="55.3638">Fachanwendung</text><rect fill="#DDDDDD" height="727.0547" style="stroke:#181818;stroke-width:0.5;" width="608.3911" x="389.8804" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143.8887" x="622.1316" y="55.3638">VZD-FHIR-Directory</text><rect fill="none" height="374.5938" style="stroke:#000000;stroke-width:1.5;" width="943.8604" x="10" y="152.8594"/><rect fill="none" height="90.2031" style="stroke:#000000;stroke-width:1.5;" width="994.2715" x="10" y="628.8516"/><g class="participant-lifeline" data-entity-uid="part1" data-qualified-name="Fachdienst" id="part1-lifeline"><g><title>Fachdienst</title><rect fill="#000000" fill-opacity="0.00000" height="642.3281" width="8" x="61.124" y="93.7266"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="65" x2="65" y1="93.7266" y2="736.0547"/></g></g><g class="participant-lifeline" data-entity-uid="part2" data-qualified-name="OAuth" id="part2-lifeline"><g><title>OAuth-Server</title><rect fill="#000000" fill-opacity="0.00000" height="642.3281" width="8" x="444.2773" y="93.7266"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="447.8804" x2="447.8804" y1="93.7266" y2="736.0547"/></g></g><g class="participant-lifeline" data-entity-uid="part3" data-qualified-name="Auth" id="part3-lifeline"><g><title>Auth-Service</title><rect fill="#000000" fill-opacity="0.00000" height="642.3281" width="8" x="704.6035" y="93.7266"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="707.8008" x2="707.8008" y1="93.7266" y2="736.0547"/></g></g><g class="participant-lifeline" data-entity-uid="part4" data-qualified-name="Proxy" id="part4-lifeline"><g><title>FHIR-Proxy</title><rect fill="#000000" fill-opacity="0.00000" height="642.3281" width="8" x="944.8604" y="93.7266"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5,5;" x1="948.4492" x2="948.4492" y1="93.7266" y2="736.0547"/></g></g><g class="participant participant-head" data-entity-uid="part1" data-qualified-name="Fachdienst" id="part1-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90.248" x="20" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.248" x="27" y="82.4248">Fachdienst</text></g><g class="participant participant-tail" data-entity-uid="part1" data-qualified-name="Fachdienst" id="part1-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90.248" x="20" y="735.0547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.248" x="27" y="755.0498">Fachdienst</text></g><g class="participant participant-head" data-entity-uid="part2" data-qualified-name="OAuth" id="part2-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108.7939" x="393.8804" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.7939" x="400.8804" y="82.4248">OAuth-Server</text></g><g class="participant participant-tail" data-entity-uid="part2" data-qualified-name="OAuth" id="part2-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="108.7939" x="393.8804" y="735.0547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="94.7939" x="400.8804" y="755.0498">OAuth-Server</text></g><g class="participant participant-head" data-entity-uid="part3" data-qualified-name="Auth" id="part3-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103.6055" x="656.8008" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.6055" x="663.8008" y="82.4248">Auth-Service</text></g><g class="participant participant-tail" data-entity-uid="part3" data-qualified-name="Auth" id="part3-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103.6055" x="656.8008" y="735.0547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.6055" x="663.8008" y="755.0498">Auth-Service</text></g><g class="participant participant-head" data-entity-uid="part4" data-qualified-name="Proxy" id="part4-head"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90.8223" x="903.4492" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.8223" x="910.4492" y="82.4248">FHIR-Proxy</text></g><g class="participant participant-tail" data-entity-uid="part4" data-qualified-name="Proxy" id="part4-tail"><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="90.8223" x="903.4492" y="735.0547"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="76.8223" x="910.4492" y="755.0498">FHIR-Proxy</text></g><g class="message" data-entity-1="part1" data-entity-2="part1" id="msg1"><line style="stroke:#181818;stroke-width:1;" x1="65.124" x2="107.124" y1="124.8594" y2="124.8594"/><line style="stroke:#181818;stroke-width:1;" x1="107.124" x2="107.124" y1="124.8594" y2="137.8594"/><line style="stroke:#181818;stroke-width:1;" x1="66.124" x2="107.124" y1="137.8594" y2="137.8594"/><polygon fill="#181818" points="76.124,133.8594,66.124,137.8594,76.124,141.8594,72.124,137.8594" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="72.124" y="119.7935">[01]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.8481" x="106.0977" y="119.7935">pr&#252;fe, ob g&#252;ltiges</text><text fill="#000000" font-family="monospace" font-size="13" lengthAdjust="spacing" textLength="148.7065" x="225.0781" y="119.7935">search-access_token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="49.5625" x="377.917" y="119.7935">vorliegt</text></g><path d="M10,152.8594 L74.4429,152.8594 L74.4429,159.9922 L64.4429,169.9922 L10,169.9922 L10,152.8594" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="374.5938" style="stroke:#000000;stroke-width:1.5;" width="943.8604" x="10" y="152.8594"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="165.9263">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="292.4238" x="89.4429" y="165.0698">[kein g&#252;ltiges search-access_token vorhanden]</text><g class="message" data-entity-1="part1" data-entity-2="part1" id="msg2"><line style="stroke:#181818;stroke-width:1;" x1="65.124" x2="107.124" y1="191.125" y2="191.125"/><line style="stroke:#181818;stroke-width:1;" x1="107.124" x2="107.124" y1="191.125" y2="204.125"/><line style="stroke:#181818;stroke-width:1;" x1="66.124" x2="107.124" y1="204.125" y2="204.125"/><polygon fill="#181818" points="76.124,200.125,66.124,204.125,76.124,208.125,72.124,204.125" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="72.124" y="186.0591">[02]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="307.5439" x="106.0977" y="186.0591">client_id und client_secret z.B. aus config lesen</text></g><g class="message" data-entity-1="part1" data-entity-2="part2" id="msg3"><polygon fill="#181818" points="436.2773,229.2578,446.2773,233.2578,436.2773,237.2578,440.2773,233.2578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="65.124" x2="442.2773" y1="233.2578" y2="233.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="72.124" y="228.1919">[03]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="238.7671" x="106.0977" y="228.1919">POST /token (client_id, client_secret)</text></g><g class="message" data-entity-1="part2" data-entity-2="part2" id="msg4"><line style="stroke:#181818;stroke-width:1;" x1="448.2773" x2="490.2773" y1="262.3906" y2="262.3906"/><line style="stroke:#181818;stroke-width:1;" x1="490.2773" x2="490.2773" y1="262.3906" y2="275.3906"/><line style="stroke:#181818;stroke-width:1;" x1="449.2773" x2="490.2773" y1="275.3906" y2="275.3906"/><polygon fill="#181818" points="459.2773,271.3906,449.2773,275.3906,459.2773,279.3906,455.2773,275.3906" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="455.2773" y="257.3247">[04]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="183.4409" x="489.251" y="257.3247">pr&#252;fe client_id, client_secret</text></g><g class="message" data-entity-1="part2" data-entity-2="part1" id="msg5"><polygon fill="#181818" points="76.124,300.5234,66.124,304.5234,76.124,308.5234,72.124,304.5234" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="70.124" x2="447.2773" y1="304.5234" y2="304.5234"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="82.124" y="299.4575">[05]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="129.1304" x="116.0977" y="299.4575">service-authz-token</text></g><g class="message" data-entity-1="part1" data-entity-2="part3" id="msg6"><polygon fill="#181818" points="696.6035,344.7891,706.6035,348.7891,696.6035,352.7891,700.6035,348.7891" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="65.124" x2="702.6035" y1="348.7891" y2="348.7891"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="72.124" y="336.1567">[06]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="168.6953" x="106.0977" y="328.5903">GET /service-authenticate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="288.958" x="106.0977" y="343.7231">Authorization: Bearer {service-authz-token}</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg7"><line style="stroke:#181818;stroke-width:1;" x1="708.6035" x2="750.6035" y1="377.9219" y2="377.9219"/><line style="stroke:#181818;stroke-width:1;" x1="750.6035" x2="750.6035" y1="377.9219" y2="390.9219"/><line style="stroke:#181818;stroke-width:1;" x1="709.6035" x2="750.6035" y1="390.9219" y2="390.9219"/><polygon fill="#181818" points="719.6035,386.9219,709.6035,390.9219,719.6035,394.9219,715.6035,390.9219" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="715.6035" y="372.856">[07]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167.2607" x="749.5771" y="372.856">Pr&#252;fe service-authz-token</text></g><g class="message" data-entity-1="part3" data-entity-2="part3" id="msg8"><line style="stroke:#181818;stroke-width:1;" x1="708.6035" x2="750.6035" y1="420.0547" y2="420.0547"/><line style="stroke:#181818;stroke-width:1;" x1="750.6035" x2="750.6035" y1="420.0547" y2="433.0547"/><line style="stroke:#181818;stroke-width:1;" x1="709.6035" x2="750.6035" y1="433.0547" y2="433.0547"/><polygon fill="#181818" points="719.6035,429.0547,709.6035,433.0547,719.6035,437.0547,715.6035,433.0547" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="715.6035" y="414.9888">[08]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="192.2832" x="749.5771" y="414.9888">Erzeuge search-access_token</text></g><g class="message" data-entity-1="part3" data-entity-2="part1" id="msg9"><polygon fill="#181818" points="76.124,473.3203,66.124,477.3203,76.124,481.3203,72.124,477.3203" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="70.124" x2="707.6035" y1="477.3203" y2="477.3203"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="82.124" y="464.688">[09]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="85.3315" x="116.0977" y="457.1216">HTTP 200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="571.708" x="116.0977" y="472.2544">{ "access_token": "search-access_token", "token_type": "bearer", "expires_in": 86400 }</text></g><g class="message" data-entity-1="part1" data-entity-2="part1" id="msg10"><line style="stroke:#181818;stroke-width:1;" x1="65.124" x2="107.124" y1="506.4531" y2="506.4531"/><line style="stroke:#181818;stroke-width:1;" x1="107.124" x2="107.124" y1="506.4531" y2="519.4531"/><line style="stroke:#181818;stroke-width:1;" x1="66.124" x2="107.124" y1="519.4531" y2="519.4531"/><polygon fill="#181818" points="76.124,515.4531,66.124,519.4531,76.124,523.4531,72.124,519.4531" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="72.124" y="501.3872">[10]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="177.9121" x="106.0977" y="501.3872">cache search-access_token</text></g><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1014.2715" x="0" y="555.0195"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1014.2715" y1="555.0195" y2="555.0195"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1014.2715" y1="558.0195" y2="558.0195"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="290.7705" x="361.7505" y="544.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="272.2446" x="367.7505" y="560.52">Suche durch Fachdienst im FHIR VZD</text><g class="message" data-entity-1="part1" data-entity-2="part4" id="msg11"><polygon fill="#181818" points="936.8604,609.8516,946.8604,613.8516,936.8604,617.8516,940.8604,613.8516" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="65.124" x2="942.8604" y1="613.8516" y2="613.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="72.124" y="601.2192">[11]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="97.5063" x="106.0977" y="593.6528">GET /search?...</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="278.5669" x="106.0977" y="608.7856">Authorization: Bearer search-access_token</text></g><path d="M10,628.8516 L74.4429,628.8516 L74.4429,635.9844 L64.4429,645.9844 L10,645.9844 L10,628.8516" fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="90.2031" style="stroke:#000000;stroke-width:1.5;" width="994.2715" x="10" y="628.8516"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="25" y="641.9185">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="198.3169" x="89.4429" y="641.062">[search_access_token ist g&#252;ltig]</text><g class="message" data-entity-1="part4" data-entity-2="part1" id="msg12"><polygon fill="#181818" points="76.124,663.1172,66.124,667.1172,76.124,671.1172,72.124,667.1172" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="70.124" x2="947.8604" y1="667.1172" y2="667.1172"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="82.124" y="662.0513">[12]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="208.019" x="116.0977" y="662.0513">HTTP 200 OK (Result Body json)</text></g><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2,2;" x1="10" x2="1004.2715" y1="676.1172" y2="676.1172"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="213.979" x="15" y="686.3276">[search_access_token ist ung&#252;ltig]</text><g class="message" data-entity-1="part4" data-entity-2="part1" id="msg13"><polygon fill="#181818" points="76.124,707.0547,66.124,711.0547,76.124,715.0547,72.124,711.0547" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="70.124" x2="947.8604" y1="711.0547" y2="711.0547"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="82.124" y="705.9888">[13]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="62.4419" x="116.0977" y="705.9888">HTTP 401</text></g><?plantuml-src ZLDTRzCm57tthxZAqoOrfQ09eOeEKMrZY8TMQyK36wfSvpOro-p87wFjj7_Mj_und9kkJI01ycJ7vvnxxhKFzquh_p170z7x-Vbjh_SzOcokLt35nPAhdwWIhrAMS-Eaa3bN3gBYA96eh8k0MpXkMK1389SANxzTn5VNds_Y2sbGE6tMTPdHH--MyGJD8neIeXzrp04Y1HBcJmYL61kzMXE0LaSZJheCWJ313z5HEMabcj0NB7PRKsa06Jjk83wl7FKXDxlj0ZkWvv3kjfcJALg88elSY6NCXK1hPqxVeueYUDGcavWwndZcu1wbgf0QA0KXp3j1nI1yxIv4a5Lk9XFmeSVzpg8mw63J7NQ1Umj2guLC8KFRg4U3xiDuD9d2gxByoK6tKnSz9JunAjHo5j16gdEgzcrvbp4FPvkOQZSOB8jykWpsgeJYvWHtUASAW3PomvtKgW_3CD3mX9yQr9z9_iNAll7IVPkNElZIRD2ds7HfDNIro-lfT0nlUZqOVRbJJn3L7aSV6jzC1o9QpDmwnm8qfwQA_xZAGuJiJ1RaTs_FWl3plvv9M3Tx3j5WR320YIyGYG-0gevyeBGKwON1uFSyKBeEDrE8V-Xskz1s8KtrAH3bmQoM01bAx3D2pL6jlqmMJcxG-Y0srCaQVbYjJXbc5bl5G-3_I_wizvgcz0i0?></g></svg>