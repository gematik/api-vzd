<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="990px" preserveAspectRatio="none" style="width:1287px;height:990px;background:#FFFFFF;" version="1.1" viewBox="0 0 1287 990" width="1287px" zoomAndPan="magnify"><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="515" x="382.25" y="27.9951">FHIR-VZD Authentisierung f&#252;r TI-Messenger-Nutzer (Versicherte)</text><rect fill="#F5F5F5" height="941.0781" style="stroke:#181818;stroke-width:0.5;" width="633" x="375" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="142" x="618" y="55.3638">VZD-FHIR-Directory</text><rect fill="#FFFFFF" height="353.2578" style="stroke:#181818;stroke-width:1.0;" width="10" x="540.5" y="279.6563"/><rect fill="#FFFFFF" height="181.4688" style="stroke:#181818;stroke-width:1.0;" width="10" x="955.5" y="727.3125"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1183.5" y="206.2578"/><rect fill="#FFFFFF" height="44.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1183.5" y="411.4531"/><rect fill="none" height="472.9219" style="stroke:#000000;stroke-width:1.5;" width="1260.5" x="10" y="167.9922"/><rect fill="none" height="132.3359" style="stroke:#000000;stroke-width:1.5;" width="1132.5" x="10" y="784.4453"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="105" x2="105" y1="93.7266" y2="933.7813"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="432" x2="432" y1="93.7266" y2="933.7813"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="545" x2="545" y1="93.7266" y2="933.7813"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="960" x2="960" y1="93.7266" y2="933.7813"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1188.5" x2="1188.5" y1="93.7266" y2="933.7813"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="170" x="20" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="27" y="82.4248">TIM-Client Versicherter</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="170" x="20" y="932.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="156" x="27" y="952.7764">TIM-Client Versicherter</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106" x="379" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="386" y="82.4248">OAuth-Server</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="106" x="379" y="932.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="92" x="386" y="952.7764">OAuth-Server</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101" x="495" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="502" y="82.4248">Auth-Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="101" x="495" y="932.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="87" x="502" y="952.7764">Auth-Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87" x="917" y="62.4297"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="924" y="82.4248">FHIR-Proxy</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="87" x="917" y="932.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="73" x="924" y="952.7764">FHIR-Proxy</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="144" x="1116.5" y="46.1328"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129" x="1124" y="66.1279">Matrix-Homeserver</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="1123.5" y="82.4248">(Messenger-Proxy)</text><rect fill="#E2E2F0" height="46.5938" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="144" x="1116.5" y="932.7813"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="129" x="1124" y="952.7764">Matrix-Homeserver</text><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="130" x="1123.5" y="969.0732">(Messenger-Proxy)</text><rect fill="#FFFFFF" height="353.2578" style="stroke:#181818;stroke-width:1.0;" width="10" x="540.5" y="279.6563"/><rect fill="#FFFFFF" height="181.4688" style="stroke:#181818;stroke-width:1.0;" width="10" x="955.5" y="727.3125"/><rect fill="#FFFFFF" height="29.1328" style="stroke:#181818;stroke-width:1.0;" width="10" x="1183.5" y="206.2578"/><rect fill="#FFFFFF" height="44.2656" style="stroke:#181818;stroke-width:1.0;" width="10" x="1183.5" y="411.4531"/><line style="stroke:#181818;stroke-width:1.0;" x1="105" x2="147" y1="139.9922" y2="139.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="147" x2="147" y1="139.9922" y2="152.9922"/><line style="stroke:#181818;stroke-width:1.0;" x1="106" x2="147" y1="152.9922" y2="152.9922"/><polygon fill="#181818" points="116,148.9922,106,152.9922,116,156.9922,112,152.9922" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="112" y="127.3599">[01]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279" x="146" y="119.7935">pr&#252;fe ob noch g&#252;ltiges search-access-token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260" x="146" y="134.9263">vom FHIR-Directory Auth-Service vorliegt</text><path d="M10,167.9922 L74,167.9922 L74,175.125 L64,185.125 L10,185.125 L10,167.9922 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="472.9219" style="stroke:#000000;stroke-width:1.5;" width="1260.5" x="10" y="167.9922"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="181.0591">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="302" x="89" y="180.2026">[kein g&#252;ltiges search-access-token vorhanden]</text><polygon fill="#181818" points="1171.5,202.2578,1181.5,206.2578,1171.5,210.2578,1175.5,206.2578" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="105" x2="1177.5" y1="206.2578" y2="206.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="112" y="201.1919">[02]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="379" x="146" y="201.1919">POST /_matrix/client/r0/user/{userId}/openid/request_token</text><polygon fill="#181818" points="116,231.3906,106,235.3906,116,239.3906,112,235.3906" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="110" x2="1187.5" y1="235.3906" y2="235.3906"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="122" y="230.3247">[03]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="720" x="156" y="230.3247">HTTP 200 OK, Result body {"access_token": "Matrix-OpenID-Token",..., "matrix_server_name": "example.com",...}</text><polygon fill="#181818" points="528.5,275.6563,538.5,279.6563,528.5,283.6563,532.5,279.6563" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="105" x2="534.5" y1="279.6563" y2="279.6563"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="112" y="267.0239">[04]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="140" x="146" y="259.4575">GET /tim-authenticate</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="289" x="146" y="274.5903">X-Matrix-OpenID-Token: Matrix-OpenID-Token</text><line style="stroke:#181818;stroke-width:1.0;" x1="550.5" x2="592.5" y1="354.1875" y2="354.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="592.5" x2="592.5" y1="354.1875" y2="367.1875"/><line style="stroke:#181818;stroke-width:1.0;" x1="551.5" x2="592.5" y1="367.1875" y2="367.1875"/><polygon fill="#181818" points="561.5,363.1875,551.5,367.1875,561.5,371.1875,557.5,367.1875" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="557.5" y="326.4224">[05]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="591.5" y="303.7231">Pr&#252;fe ob matrix_server_name</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="591.5" y="318.856">in F&#246;derationsliste enthalten</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="357" x="591.5" y="333.9888">und pr&#252;fe das isInsurance Flag des matrix_server_name</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="591.5" y="349.1216">in der F&#246;derationsliste</text><polygon fill="#181818" points="1171.5,407.4531,1181.5,411.4531,1171.5,415.4531,1175.5,411.4531" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="550.5" x2="1177.5" y1="411.4531" y2="411.4531"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="557.5" y="398.8208">[06]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="135" x="591.5" y="391.2544">GET /openid/userinfo/</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="380" x="591.5" y="406.3872">request header, Authorization: Bearer Matrix-OpenID-Token</text><polygon fill="#181818" points="561.5,451.7188,551.5,455.7188,561.5,459.7188,557.5,455.7188" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="555.5" x2="1187.5" y1="455.7188" y2="455.7188"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="567.5" y="443.0864">[07]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="601.5" y="435.52">HTTP 200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="601.5" y="450.6528">(Result Body MXID des Nutzers)</text><line style="stroke:#181818;stroke-width:1.0;" x1="550.5" x2="592.5" y1="515.1172" y2="515.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="592.5" x2="592.5" y1="515.1172" y2="528.1172"/><line style="stroke:#181818;stroke-width:1.0;" x1="551.5" x2="592.5" y1="528.1172" y2="528.1172"/><polygon fill="#181818" points="561.5,524.1172,551.5,528.1172,561.5,532.1172,557.5,528.1172" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="557.5" y="494.9185">[08]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="189" x="591.5" y="479.7856">Erzeuge search-access-token</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="337" x="591.5" y="494.9185">bei isInsurance=true f&#252;r die /fdv/search Schnittstelle,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="314" x="591.5" y="510.0513">bei isInsurance=true f&#252;r die /search Schnittstelle.</text><polygon fill="#181818" points="116,628.9141,106,632.9141,116,636.9141,112,632.9141" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="110" x2="544.5" y1="632.9141" y2="632.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="122" y="590.0161">[09]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="82" x="156" y="552.1841">HTTP 200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="156" y="567.3169">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="255" x="164" y="582.4497">"access_token"="search-access-token",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="141" x="164" y="597.5825">"token_type":"bearer",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="164" y="612.7153">"expires_in":86400</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8" x="156" y="627.8481">}</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1280.5" x="0" y="668.4805"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1280.5" y1="668.4805" y2="668.4805"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1280.5" y1="671.4805" y2="671.4805"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2.0;" width="327" x="476.75" y="657.9141"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="308" x="482.75" y="673.981">...Suche durch Versicherte im FHIR VZD...</text><polygon fill="#181818" points="943.5,723.3125,953.5,727.3125,943.5,731.3125,947.5,727.3125" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="105" x2="949.5" y1="727.3125" y2="727.3125"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="112" y="714.6802">[10]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="118" x="146" y="707.1138">GET /fdv/search?...</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273" x="146" y="722.2466">Authorization: Bearer search-access-token</text><line style="stroke:#181818;stroke-width:1.0;" x1="965.5" x2="1007.5" y1="756.4453" y2="756.4453"/><line style="stroke:#181818;stroke-width:1.0;" x1="1007.5" x2="1007.5" y1="756.4453" y2="769.4453"/><line style="stroke:#181818;stroke-width:1.0;" x1="966.5" x2="1007.5" y1="769.4453" y2="769.4453"/><polygon fill="#181818" points="976.5,765.4453,966.5,769.4453,976.5,773.4453,972.5,769.4453" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="972.5" y="751.3794">[11]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="1006.5" y="751.3794">pr&#252;fe search-access-token</text><path d="M10,784.4453 L74,784.4453 L74,791.5781 L64,801.5781 L10,801.5781 L10,784.4453 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="132.3359" style="stroke:#000000;stroke-width:1.5;" width="1132.5" x="10" y="784.4453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="25" y="797.5122">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="204" x="89" y="796.6558">[search-access-token ist g&#252;ltig]</text><line style="stroke:#181818;stroke-width:1.0;" x1="965.5" x2="1007.5" y1="822.7109" y2="822.7109"/><line style="stroke:#181818;stroke-width:1.0;" x1="1007.5" x2="1007.5" y1="822.7109" y2="835.7109"/><line style="stroke:#181818;stroke-width:1.0;" x1="966.5" x2="1007.5" y1="835.7109" y2="835.7109"/><polygon fill="#181818" points="976.5,831.7109,966.5,835.7109,976.5,839.7109,972.5,835.7109" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="972.5" y="817.645">[12]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124" x="1006.5" y="817.645">suche im FHIR-VZD</text><polygon fill="#181818" points="116,860.8438,106,864.8438,116,868.8438,112,864.8438" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="110" x2="954.5" y1="864.8438" y2="864.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="122" y="859.7778">[13]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="201" x="156" y="859.7778">HTTP 200 OK (Result Body json)</text><line style="stroke:#000000;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="10" x2="1142.5" y1="873.8438" y2="873.8438"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="215" x="15" y="884.0542">[search-accesstoken ist ung&#252;ltig]</text><polygon fill="#181818" points="116,904.7813,106,908.7813,116,912.7813,112,908.7813" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="110" x2="959.5" y1="908.7813" y2="908.7813"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="30" x="122" y="903.7153">[14]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="60" x="156" y="903.7153">HTTP 401</text></g></svg>