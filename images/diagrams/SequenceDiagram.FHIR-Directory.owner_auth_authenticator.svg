<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1819px" preserveAspectRatio="none" style="width:1899px;height:1819px;background:#FFFFFF;" version="1.1" viewBox="0 0 1899 1819" width="1899px" zoomAndPan="magnify"><title>Entkoppelte FHIR-VZD Authentisierung</title><defs/><g><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" textLength="309.0117" x="791.1368" y="27.9951">Entkoppelte FHIR-VZD Authentisierung</text><rect fill="#F5F5F5" height="1770.5703" style="stroke:#181818;stroke-width:0.5;" width="154.4146" x="1186.1216" y="43.2969"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="143.8887" x="1189.1216" y="55.3638">VZD-FHIR-Directory</text><rect fill="#FFFFFF" height="1524.7109" style="stroke:#181818;stroke-width:1;" width="10" x="271.0313" y="149.7266"/><rect fill="#FFFFFF" height="299.7266" style="stroke:#181818;stroke-width:1;" width="10" x="543.3125" y="743.8438"/><rect fill="#FFFFFF" height="44.2656" style="stroke:#181818;stroke-width:1;" width="10" x="939.1064" y="818.375"/><rect fill="#FFFFFF" height="39.6992" style="stroke:#181818;stroke-width:1;" width="10" x="939.1064" y="1105.4023"/><rect fill="#FFFFFF" height="1450.1797" style="stroke:#181818;stroke-width:1;" width="10" x="1258.3289" y="224.2578"/><rect fill="none" height="1029.3906" style="stroke:#000000;stroke-width:1.5;" width="1698.4104" x="10" y="645.0469"/><rect fill="none" height="303.4688" style="stroke:#000000;stroke-width:1.5;" width="1305.1316" x="20" y="1363.9688"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="93" x2="93" y1="118.5938" y2="1734.5703"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="275.6353" x2="275.6353" y1="118.5938" y2="1734.5703"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="547.6035" x2="547.6035" y1="118.5938" y2="1734.5703"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="943.6084" x2="943.6084" y1="118.5938" y2="1734.5703"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1262.5261" x2="1262.5261" y1="118.5938" y2="1734.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132.043" x="24" y="115.292">Leistungserbringer</text><ellipse cx="93.0215" cy="50.7969" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M93.0215,58.7969 L93.0215,85.7969 M80.0215,66.7969 L106.0215,66.7969 M93.0215,85.7969 L80.0215,100.7969 M93.0215,85.7969 L106.0215,100.7969 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132.043" x="24" y="1746.5654">Leistungserbringer</text><ellipse cx="93.0215" cy="1758.3672" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M93.0215,1766.3672 L93.0215,1793.3672 M80.0215,1774.3672 L106.0215,1774.3672 M93.0215,1793.3672 L80.0215,1808.3672 M93.0215,1793.3672 L106.0215,1808.3672 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88.792" x="231.6353" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74.792" x="238.6353" y="107.292">TI-M Client</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="88.792" x="231.6353" y="1733.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="74.792" x="238.6353" y="1753.5654">TI-M Client</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="171.418" x="462.6035" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="157.418" x="469.6035" y="107.292">gematik Authenticator</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="171.418" x="462.6035" y="1733.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="157.418" x="469.6035" y="1753.5654">gematik Authenticator</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="148.9961" x="869.6084" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134.9961" x="876.6084" y="107.292">gematik IDP-Dienst</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="148.9961" x="869.6084" y="1733.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="134.9961" x="876.6084" y="1753.5654">gematik IDP-Dienst</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103.6055" x="1211.5261" y="87.2969"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.6055" x="1218.5261" y="107.292">Auth-Service</text><rect fill="#E2E2F0" height="30.2969" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="103.6055" x="1211.5261" y="1733.5703"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="89.6055" x="1218.5261" y="1753.5654">Auth-Service</text><rect fill="#FFFFFF" height="1524.7109" style="stroke:#181818;stroke-width:1;" width="10" x="271.0313" y="149.7266"/><rect fill="#FFFFFF" height="299.7266" style="stroke:#181818;stroke-width:1;" width="10" x="543.3125" y="743.8438"/><rect fill="#FFFFFF" height="44.2656" style="stroke:#181818;stroke-width:1;" width="10" x="939.1064" y="818.375"/><rect fill="#FFFFFF" height="39.6992" style="stroke:#181818;stroke-width:1;" width="10" x="939.1064" y="1105.4023"/><rect fill="#FFFFFF" height="1450.1797" style="stroke:#181818;stroke-width:1;" width="10" x="1258.3289" y="224.2578"/><polygon fill="#181818" points="259.0313,145.7266,269.0313,149.7266,259.0313,153.7266,263.0313,149.7266" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="93.0215" x2="265.0313" y1="149.7266" y2="149.7266"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="100.0215" y="144.6606">[01]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="125.0361" x="133.9951" y="144.6606">Anmeldung starten</text><polygon fill="#181818" points="1246.3289,220.2578,1256.3289,224.2578,1246.3289,228.2578,1250.3289,224.2578" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="281.0313" x2="1252.3289" y1="224.2578" y2="224.2578"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="288.0313" y="196.4927">[02]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.188" x="322.0049" y="173.7935">Decoupled Authorization Request</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="242.728" x="322.0049" y="188.9263">POST /owner-authenticate-decoupled</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="388.3433" x="322.0049" y="204.0591">Header: Content-Type=application/x-www-form-urlencoded</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="408.8779" x="322.0049" y="219.1919">Body: grant_type=urn:telematik:params:grant-type:decoupled</text><line style="stroke:#181818;stroke-width:1;" x1="1268.3289" x2="1310.3289" y1="253.3906" y2="253.3906"/><line style="stroke:#181818;stroke-width:1;" x1="1310.3289" x2="1310.3289" y1="253.3906" y2="266.3906"/><line style="stroke:#181818;stroke-width:1;" x1="1269.3289" x2="1310.3289" y1="266.3906" y2="266.3906"/><polygon fill="#181818" points="1279.3289,262.3906,1269.3289,266.3906,1279.3289,270.3906,1275.3289,266.3906" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="1275.3289" y="248.3247">[03]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="396.4492" x="1309.3025" y="248.3247">Erzeuge PKCE_code_challenge, PKCE_code_verifier und state</text><line style="stroke:#181818;stroke-width:1;" x1="1268.3289" x2="1310.3289" y1="307.1563" y2="307.1563"/><line style="stroke:#181818;stroke-width:1;" x1="1310.3289" x2="1310.3289" y1="307.1563" y2="320.1563"/><line style="stroke:#181818;stroke-width:1;" x1="1269.3289" x2="1310.3289" y1="320.1563" y2="320.1563"/><polygon fill="#181818" points="1279.3289,316.1563,1269.3289,320.1563,1279.3289,324.1563,1275.3289,320.1563" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="1275.3289" y="302.0903">[04]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="133.0024" x="1309.3025" y="302.0903">Erzeuge auth_req_id</text><path d="M1463.9761,279.3906 L1463.9761,334.3906 L1875.9761,334.3906 L1875.9761,289.3906 L1865.9761,279.3906 L1463.9761,279.3906 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M1865.9761,279.3906 L1865.9761,289.3906 L1875.9761,289.3906 L1865.9761,279.3906 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="151.9185" x="1469.9761" y="296.4575">Siehe Bildungsregel:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="391.9805" x="1469.9761" y="311.5903">https://openid.net/specs/openid-client-initiated-backchannel</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="297.5273" x="1469.9761" y="326.7231">-authentication-core-1_0.html#rfc.section.7.3</text><line style="stroke:#181818;stroke-width:1;" x1="1268.3289" x2="1310.3289" y1="376.0547" y2="376.0547"/><line style="stroke:#181818;stroke-width:1;" x1="1310.3289" x2="1310.3289" y1="376.0547" y2="389.0547"/><line style="stroke:#181818;stroke-width:1;" x1="1269.3289" x2="1310.3289" y1="389.0547" y2="389.0547"/><polygon fill="#181818" points="1279.3289,385.0547,1269.3289,389.0547,1279.3289,393.0547,1275.3289,389.0547" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="1275.3289" y="363.4224">[05]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="402.5684" x="1309.3025" y="355.856">code, state und auth_req_id werden als Autorisierungsauftrag</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="245.4321" x="1313.4348" y="370.9888">in einem persistent Store gespeichert</text><polygon fill="#181818" points="292.0313,626.0469,282.0313,630.0469,292.0313,634.0469,288.0313,630.0469" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="286.0313" x2="1257.3289" y1="630.0469" y2="630.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="298.0313" y="519.0513">[06]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="279.6523" x="332.0049" y="413.1216">Decoupled Authorization Response 200 OK</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5.0718" x="332.0049" y="428.2544">(</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="124.96" x="365.0635" y="443.3872">"auth_req_id": "...",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="96.0845" x="365.0635" y="458.52">"poll_uri": "...",</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="91.0317" x="365.0635" y="473.6528">{redirect_uri}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="259.124" x="456.0952" y="473.6528">: "https://idp-ref.app.ti-dienste.de/auth?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="137.1157" x="398.1221" y="488.7856">response_type=code</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="240.2334" x="398.1221" y="503.9185">&amp;client_id=GEMgematFHI4HkPrd8SR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="163.5854" x="398.1221" y="519.0513">&amp;scope=fhir-vzd+openid</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="629.1035" x="398.1221" y="534.1841">&amp;redirect_uri=https%3A%2F%2Ffhir-directory-ref.vzd.ti-dienste.de%2Fsignin-gematik-idp-dienst</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="241.6807" x="398.1221" y="549.3169">&amp;state=HkX8By1qMekEg4a7B1aXyw</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="475.7568" x="398.1221" y="564.4497">&amp;code_challenge=a0kY3HugNKgveqhBQjc1tmX4_m-OT7FMF175rDlOIOM</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="221.8252" x="398.1221" y="579.5825">&amp;code_challenge_method=S256",</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115.4385" x="369.1958" y="594.7153">"expires_in": 600,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="78.3047" x="369.1958" y="609.8481">"interval": 3</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5.0718" x="332.0049" y="624.981">)</text><path d="M10,645.0469 L79.4893,645.0469 L79.4893,652.1797 L69.4893,662.1797 L10,662.1797 L10,645.0469 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="1029.3906" style="stroke:#000000;stroke-width:1.5;" width="1698.4104" x="10" y="645.0469"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="24.4893" x="25" y="658.1138">par</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="128.8257" x="94.4893" y="657.2573">[Authenticator Flow]</text><polygon fill="#181818" points="531.3125,739.8438,541.3125,743.8438,531.3125,747.8438,535.3125,743.8438" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="281.0313" x2="537.3125" y1="743.8438" y2="743.8438"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="288.0313" y="708.5122">[07]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="106.1899" x="322.0049" y="678.2466">Deeplink-Aufruf:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="108.0371" x="322.0049" y="693.3794">authenticator://?</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="110.0112" x="330.2695" y="708.5122">challenge_path=</text><text fill="#000000" font-family="sans-serif" font-size="13" font-style="italic" lengthAdjust="spacing" textLength="91.0317" x="440.2808" y="708.5122">{redirect_uri}</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="134.9766" x="355.0635" y="723.645">&amp;callback=DIRECT</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="120.7388" x="355.0635" y="738.7778">&amp;cardType=HBA</text><polygon fill="#181818" points="564.3125,814.375,554.3125,818.375,564.3125,822.375,560.3125,818.375" style="stroke:#181818;stroke-width:1;"/><polygon fill="#181818" points="927.1064,814.375,937.1064,818.375,927.1064,822.375,931.1064,818.375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="558.3125" x2="933.1064" y1="818.375" y2="818.375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="570.3125" y="790.6099">[08]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="273.4697" x="604.2861" y="767.9106">Der Authenticator interagiert mit dem IDP</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="307.125" x="608.4185" y="783.0435">und &#252;ber einen Konnektor mit den Smartcards.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="315.1294" x="604.2861" y="798.1763">Am Ende des Prozesses erh&#228;lt der Authenticator</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.4058" x="608.4185" y="813.3091">den auth_code vom IDP.</text><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="166.1499" x="770.9565" y="813.3091">Siehe n&#228;chster Aufruf!</text><polygon fill="#181818" points="564.3125,858.6406,554.3125,862.6406,564.3125,866.6406,560.3125,862.6406" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="558.3125" x2="943.1064" y1="862.6406" y2="862.6406"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="570.3125" y="850.0083">[09]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="304.8652" x="604.2861" y="842.4419">302 Redirect auf die redirect_uri des VZD-FHIR</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="224.9165" x="608.4185" y="857.5747">mit dem auth_code und dem state</text><polygon fill="#181818" points="1246.3289,918.0391,1256.3289,922.0391,1246.3289,926.0391,1250.3289,922.0391" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="553.3125" x2="1252.3289" y1="922.0391" y2="922.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="560.3125" y="901.8403">[10]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="325.6475" x="594.2861" y="886.7075">Der Authenticator ruft selbst mit einem HTTP Get,</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="260.4189" x="594.2861" y="901.8403">redirect_uri&amp;code=XXX&amp;state=YYY auf.</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="5.0718" x="594.2861" y="916.9731">)</text><line style="stroke:#181818;stroke-width:1;" x1="1268.3289" x2="1310.3289" y1="966.3047" y2="966.3047"/><line style="stroke:#181818;stroke-width:1;" x1="1310.3289" x2="1310.3289" y1="966.3047" y2="979.3047"/><line style="stroke:#181818;stroke-width:1;" x1="1269.3289" x2="1310.3289" y1="979.3047" y2="979.3047"/><polygon fill="#181818" points="1279.3289,975.3047,1269.3289,979.3047,1279.3289,983.3047,1275.3289,979.3047" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="1275.3289" y="953.6724">[11]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="270.6133" x="1309.3025" y="946.106">Finde via state den Autorisierungsauftrag</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="377.1079" x="1309.3025" y="961.2388">und speichere auth_code in diesem Autorisierungsauftrag</text><polygon fill="#181818" points="564.3125,1004.4375,554.3125,1008.4375,564.3125,1012.4375,560.3125,1008.4375" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="558.3125" x2="1257.3289" y1="1008.4375" y2="1008.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="570.3125" y="1003.3716">[12]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.8369" x="604.2861" y="1003.3716">200 OK, Empty Body</text><line style="stroke:#181818;stroke-width:1;" x1="553.3125" x2="595.3125" y1="1042.5703" y2="1042.5703"/><line style="stroke:#181818;stroke-width:1;" x1="595.3125" x2="595.3125" y1="1042.5703" y2="1055.5703"/><line style="stroke:#181818;stroke-width:1;" x1="548.3125" x2="595.3125" y1="1055.5703" y2="1055.5703"/><polygon fill="#181818" points="558.3125,1051.5703,548.3125,1055.5703,558.3125,1059.5703,554.3125,1055.5703" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="560.3125" y="1037.5044">[13]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="166.9243" x="594.2861" y="1037.5044">Anwendung wird beendet</text><polygon fill="#181818" points="960.1064,1101.4023,950.1064,1105.4023,960.1064,1109.4023,956.1064,1105.4023" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="954.1064" x2="1257.3289" y1="1105.4023" y2="1105.4023"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="966.1064" y="1092.77">[14]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="218.2769" x="1000.0801" y="1085.2036">&#220;bergabe des auth_code und des</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="234.8442" x="1000.0801" y="1100.3364">key_verifier an den Token Endpunkt</text><path d="M476,1063.5703 L476,1118.5703 L933,1118.5703 L933,1073.5703 L923,1063.5703 L476,1063.5703 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M923,1063.5703 L923,1073.5703 L933,1073.5703 L923,1063.5703 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="45.9063" x="482" y="1080.6372">Siehe:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="426.2832" x="482" y="1095.77">https://github.com/gematik/api-ti-messenger/blob/main/docs/IDP/</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="436.8774" x="482" y="1110.9028">idp.adoc#3231-erzeugung-des-key_verifier-durch-die-relying-party</text><polygon fill="#181818" points="1246.3289,1141.1016,1256.3289,1145.1016,1246.3289,1149.1016,1250.3289,1145.1016" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="944.1064" x2="1252.3289" y1="1145.1016" y2="1145.1016"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="951.1064" y="1140.0356">[15]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="121.583" x="985.0801" y="1140.0356">signierter id_token</text><line style="stroke:#181818;stroke-width:1;" x1="1268.3289" x2="1310.3289" y1="1189.3672" y2="1189.3672"/><line style="stroke:#181818;stroke-width:1;" x1="1310.3289" x2="1310.3289" y1="1189.3672" y2="1202.3672"/><line style="stroke:#181818;stroke-width:1;" x1="1269.3289" x2="1310.3289" y1="1202.3672" y2="1202.3672"/><polygon fill="#181818" points="1279.3289,1198.3672,1269.3289,1202.3672,1279.3289,1206.3672,1275.3289,1202.3672" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="1275.3289" y="1176.7349">[16]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="338.8125" x="1309.3025" y="1169.1685">Erzeuge owner-accesstoken auf Basis des id_tokens</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="308.4707" x="1309.3025" y="1184.3013">und speichere dieses am Autorisierungsauftrag</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="10" x2="1708.4104" y1="1211.3672" y2="1211.3672"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="109.2158" x="15" y="1221.5776">[TI-M Client pollt]</text><polygon fill="#181818" points="1246.3289,1272.5703,1256.3289,1276.5703,1246.3289,1280.5703,1250.3289,1276.5703" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="281.0313" x2="1252.3289" y1="1276.5703" y2="1276.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="288.0313" y="1256.3716">[17]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="252.2432" x="322.0049" y="1241.2388">Access Token Request POST {poll_uri}</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246.689" x="322.0049" y="1256.3716">aus Decopled Authorization Response</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="220.7651" x="322.0049" y="1271.5044">Body: auth_req_id={auth_req_id}</text><line style="stroke:#181818;stroke-width:1;" x1="1268.3289" x2="1310.3289" y1="1335.9688" y2="1335.9688"/><line style="stroke:#181818;stroke-width:1;" x1="1310.3289" x2="1310.3289" y1="1335.9688" y2="1348.9688"/><line style="stroke:#181818;stroke-width:1;" x1="1269.3289" x2="1310.3289" y1="1348.9688" y2="1348.9688"/><polygon fill="#181818" points="1279.3289,1344.9688,1269.3289,1348.9688,1279.3289,1352.9688,1275.3289,1348.9688" style="stroke:#181818;stroke-width:1;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="1275.3289" y="1315.77">[18]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="263.4595" x="1309.3025" y="1300.6372">Pr&#252;fe ob f&#252;r die &#252;bergebene auth_req_id</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="248.3521" x="1313.4348" y="1315.77">ein Autorisierungsauftrag vorliegt und</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="228.0142" x="1309.3025" y="1330.9028">ggf. bereits ein owner-accesstoken</text><path d="M20,1363.9688 L84.4429,1363.9688 L84.4429,1371.1016 L74.4429,1381.1016 L20,1381.1016 L20,1363.9688 " fill="#EEEEEE" style="stroke:#000000;stroke-width:1.5;"/><rect fill="none" height="303.4688" style="stroke:#000000;stroke-width:1.5;" width="1305.1316" x="20" y="1363.9688"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19.4429" x="35" y="1377.0356">alt</text><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="87.7476" x="99.4429" y="1376.1792">[Poll Pending]</text><polygon fill="#181818" points="292.0313,1416.3672,282.0313,1420.3672,292.0313,1424.3672,288.0313,1420.3672" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="286.0313" x2="1257.3289" y1="1420.3672" y2="1420.3672"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="298.0313" y="1415.3013">[19]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="178.312" x="332.0049" y="1415.3013">400 Bad Request (Pending)</text><path d="M30,1386.1016 L30,1441.1016 L265,1441.1016 L265,1396.1016 L255,1386.1016 L30,1386.1016 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M255,1386.1016 L255,1396.1016 L265,1396.1016 L255,1386.1016 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="36" y="1403.1685">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="205.772" x="44.2646" y="1418.3013">"error":"authorization_pending"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="36" y="1433.4341">}</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="20" x2="1325.1316" y1="1447.5" y2="1447.5"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="86.394" x="25" y="1457.7104">[Poll Success]</text><polygon fill="#181818" points="292.0313,1496.5703,282.0313,1500.5703,292.0313,1504.5703,288.0313,1500.5703" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="286.0313" x2="1257.3289" y1="1500.5703" y2="1500.5703"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="298.0313" y="1495.5044">[20]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="114.3086" x="332.0049" y="1495.5044">200 OK (Success)</text><path d="M104,1466.3047 L104,1521.3047 L265,1521.3047 L265,1476.3047 L255,1466.3047 L104,1466.3047 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M255,1466.3047 L255,1476.3047 L265,1476.3047 L255,1466.3047 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="110" y="1483.3716">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="131.9487" x="118.2646" y="1498.5044">"access_token": "..."</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="110" y="1513.6372">}</text><line style="stroke:#000000;stroke-width:1;stroke-dasharray:2.0,2.0;" x1="20" x2="1325.1316" y1="1527.7031" y2="1527.7031"/><text fill="#000000" font-family="sans-serif" font-size="11" font-weight="bold" lengthAdjust="spacing" textLength="68.3901" x="25" y="1537.9136">[Poll Error]</text><polygon fill="#181818" points="292.0313,1607.0391,282.0313,1611.0391,292.0313,1615.0391,288.0313,1611.0391" style="stroke:#181818;stroke-width:1;"/><line style="stroke:#181818;stroke-width:1;" x1="286.0313" x2="1257.3289" y1="1611.0391" y2="1611.0391"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="29.9736" x="298.0313" y="1605.9731">[21]</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="158.082" x="332.0049" y="1605.9731">400 Bad Request (Error)</text><path d="M77,1546.5078 L77,1661.5078 L265,1661.5078 L265,1556.5078 L255,1546.5078 L77,1546.5078 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><path d="M255,1546.5078 L255,1556.5078 L265,1556.5078 L255,1546.5078 " fill="#FEFFDD" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="83" y="1563.5747">{</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="159.0723" x="91.2646" y="1578.7075">"error": "access_denied"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29.8276" x="91.2646" y="1593.8403">..or..</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156.8823" x="91.2646" y="1608.9731">"error": "expired_token"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="29.8276" x="91.2646" y="1624.106">..or..</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="134.9639" x="91.2646" y="1639.2388">"error": "slow_down"</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="8.271" x="83" y="1654.3716">}</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1;" width="1892.2854" x="0" y="1702.0039"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1892.2854" y1="1702.0039" y2="1702.0039"/><line style="stroke:#000000;stroke-width:1;" x1="0" x2="1892.2854" y1="1705.0039" y2="1705.0039"/><rect fill="#EEEEEE" height="23.1328" style="stroke:#000000;stroke-width:2;" width="156.2256" x="868.0299" y="1691.4375"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="137.6997" x="874.0299" y="1707.5044">...fachlicher flow...</text><!--SRC=[VLVTKjj65BxNKsoTIITnMDdy96GyCHqC9Z2Kuc8tXTOTprewbhQMLc9tPSSml4alynYvuyLwTYNR4fWGBj3ksNFEzvtVi4md8el78Cas_gjz6X_ytMp-KtCqrn6GMbVeQPAc46aW9wTdL_JBNyVaCDCX2CqL1vc9eEOupDE997yeLCCKgVqAN6cymU-nv280MNDI9ZNtUCg49eEpYwE8emehFJYZ5oJ_heejxNZCQ3UY0SHCysdr1ksNNws4pevxz1YrAbqpZy_yDFzonibNWZYe1NJC9HZl5-JLdo7Nq8-JAJW4VofAZKNQ1pdZ7bXrN-vyS-Q0y0agT1o3dXwieBrxroA78eR8HoA8qgWCXEEieTE3fGuZUWnUagKH-1PR8laTOaW4kOBR39GUYjvbVq0QoLoW5RQ63zHVlXoAKs0-o1OvIWGQqtImIA7DqZGoagYjyPNEvtCwIMHCCnc1y1BVlEia_g950eb8HzgyoQHeQOXo8bj818jLozvJSzzQsKIY2X0bF2tIbNUG1K1wvqVTaJ4oya8MeS40jag7Cv1yWab4CYGHATBW_4YRWJsIS3lYlYCIp4Z9Wr2tIBtUvn02wN1Bjf8GGDIgruSYr3fLhKOZIK5mtnMW6oe5JnK7rBEXe5nmpT6wJyVCcwAhGa0q56MUaJtg9HBezgZfXZgENic9vofC7RnnzztTZPuRb5ivCeknX83CGVeW28kK2Jb6l2WdnRA9bYmO2i850IuW9Yb8XILbqgQFea02G1pS2q5gnrcRHjkh1FjHJgaq4Gh8JhD9Bi_9KBmPYg6kbRohjKZDTTtQbhr8aoWQPP9NJXkDUmc-hHvpzz1euEsISEwdLCB4nUHpDQU-BJnmVMWO8x-OzqCj2p_od3DSvUS_vs51DzgVknUsdB5KzqwdFUb_x5yLGih38BOd8PTqTkU_ooDQt9KTQrkVNkyUljuvmL_xm5yMlNKIdrUTH3750y45BNe9DNZo-wLr4zFswVJwOsUnVNi1qswmn_Oxs-nwCL-YgEHzcpMdDxkdMV3RUJ23sx3p-x_UjewlzqOnlHpidroSRE-_byVHvTdbnKO5enWmY7wxl_F-Gnu1KeElAI9H8oumD1-QpUAOO_dB6OlmS7Setjh- -AIRdaJ9_4atgWZaFGcmTOWfFSmcCfkqXeALHJ3C64X2rXwcJ8VjvtbXdAhNV_PGpDHN-_ZigdiqCFLPd4lVTghJpc6zxbJz_6HoUjMwSw-UOh5mMO3beqdCDV6nOh3ves-cvXw_c-bcwaYGymGhUshUv7A2z6DipCO3vGx5OKowmWUyKAGdapjG2ly26Jv-Yupu4yDem5QmAHiJAp9Bh65trP74upSln9mo3ms5Fo6-5PXdd6EqcZjOdJbvg7T2CET8cKthsd9seVqbtBKF1h8voTkf3pYQ-Spqd_Nygx9NxbVFkKMdDL4GZLNERTwFJWU37laC6lEjx9tDsFRrzNLH7ZStDmQ5Qt9mKtiyuORj6MT5YpHilj0BxOGeMXwKu6ABH8uK-hJnOTdi4wxpvhT5kd6g5yICm2enzA3wISqyd-EuD_DypYMEVS0lq4iRzA2Ifu__OTu5R9odqzC0gQ6Omc8z0LcUImDSFeH9mZGJKvrFkGWcwo5N6Mi1rs4sThqaRXIDgi5IJh6NnIPrpUBL64V9k14pBXf-WeCFqnFh4TkPo_3xrUxExZO5EryH5kuIYfRTeduclT1qFcoKqG9NEMgseeKZGUEEG6oNnB930DmVQUFycerdyxjONZmFdREoDiKx34URvMYfGZqDjuqmSlXIa1s8S9gLzaXY9fRUl6rX6Aq71TV5WaNiVdM_d7GFfjSfEq5_C42NcrDfSBRlInyF6yZeoSVl4-HYJ2QFtwKjSDkX0XY3gEmuGplzDqF6LYCHMA1jEWr544nSp4S9N2lxwXdNkAHZ3-iXFjB3jCLGlhGsx65XT9Y_OkPD8VzsdOxEFIv-DP0Ij- -MtHjMv8pINBhcFDZTsBp9usDjzpFhKhakIwQBXUHD8VNCOeudpvBbChBPJjVuzeALPm2jy4lmLbQnFZduDRnotKIwRaKcdyH50hyWet3cZdoCJDLduPVRzChFyc7fFnjEkuswtGdpmiYM1vcWMZmXxVR_]--></g></svg>