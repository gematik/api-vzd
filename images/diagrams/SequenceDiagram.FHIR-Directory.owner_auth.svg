<?xml version="1.0" encoding="us-ascii" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="708.3333px" preserveAspectRatio="none" style="width:1044px;height:708px;background:#FFFFFF;" version="1.1" viewBox="0 0 1044 708" width="1044.7917px" zoomAndPan="magnify"><defs/><g><rect fill="#F5F5F5" height="695.9147" style="stroke:#181818;stroke-width:0.5208333333333334;" width="192.7083" x="846.3542" y="6.25"/><text fill="#000000" font-family="sans-serif" font-size="16.6667" font-weight="bold" lengthAdjust="spacing" textLength="181.25" x="849.4792" y="21.7204">VZD-FHIR-Directory</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="5.2083" x="1030.7292" y="22.4574">&#160;</text><rect fill="#FFFFFF" height="584.2285" style="stroke:#181818;stroke-width:1.0416666666666667;" width="10.4167" x="79.6875" y="72.8353"/><rect fill="#FFFFFF" height="30.3467" style="stroke:#181818;stroke-width:1.0416666666666667;" width="10.4167" x="580.7292" y="356.0954"/><rect fill="#FFFFFF" height="30.3467" style="stroke:#181818;stroke-width:1.0416666666666667;" width="10.4167" x="784.8958" y="181.5837"/><rect fill="#FFFFFF" height="30.3467" style="stroke:#181818;stroke-width:1.0416666666666667;" width="10.4167" x="784.8958" y="530.6071"/><rect fill="#FFFFFF" height="30.3467" style="stroke:#181818;stroke-width:1.0416666666666667;" width="10.4167" x="937.5" y="94.8486"/><rect fill="#FFFFFF" height="30.3467" style="stroke:#181818;stroke-width:1.0416666666666667;" width="10.4167" x="937.5" y="617.3421"/><line style="stroke:#181818;stroke-width:0.5208333333333334;stroke-dasharray:5.0,5.0;" x1="84.375" x2="84.375" y1="62.4186" y2="666.4388"/><line style="stroke:#181818;stroke-width:0.5208333333333334;stroke-dasharray:5.0,5.0;" x1="585.9375" x2="585.9375" y1="62.4186" y2="666.4388"/><line style="stroke:#181818;stroke-width:0.5208333333333334;stroke-dasharray:5.0,5.0;" x1="790.1042" x2="790.1042" y1="62.4186" y2="666.4388"/><line style="stroke:#181818;stroke-width:0.5208333333333334;stroke-dasharray:5.0,5.0;" x1="942.1875" x2="942.1875" y1="62.4186" y2="666.4388"/><rect fill="#E3E3E3" height="31.5592" rx="2.6042" ry="2.6042" style="stroke:#181818;stroke-width:0.5208333333333334;" width="159.375" x="5.2083" y="29.8177"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="144.7917" x="12.5" y="50.646">TI-Messenger-Client</text><rect fill="#E3E3E3" height="31.5592" rx="2.6042" ry="2.6042" style="stroke:#181818;stroke-width:0.5208333333333334;" width="159.375" x="5.2083" y="665.3971"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="144.7917" x="12.5" y="686.2254">TI-Messenger-Client</text><rect fill="#E3E3E3" height="31.5592" rx="2.6042" ry="2.6042" style="stroke:#181818;stroke-width:0.5208333333333334;" width="181.25" x="495.3125" y="29.8177"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="166.6667" x="502.6042" y="50.646">Smartcard(HBA/SMC-B)</text><rect fill="#E3E3E3" height="31.5592" rx="2.6042" ry="2.6042" style="stroke:#181818;stroke-width:0.5208333333333334;" width="181.25" x="495.3125" y="665.3971"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="166.6667" x="502.6042" y="686.2254">Smartcard(HBA/SMC-B)</text><rect fill="#E3E3E3" height="31.5592" rx="2.6042" ry="2.6042" style="stroke:#181818;stroke-width:0.5208333333333334;" width="100" x="740.1042" y="29.8177"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="85.4167" x="747.3958" y="50.646">gematik IDP</text><rect fill="#E3E3E3" height="31.5592" rx="2.6042" ry="2.6042" style="stroke:#181818;stroke-width:0.5208333333333334;" width="100" x="740.1042" y="665.3971"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="85.4167" x="747.3958" y="686.2254">gematik IDP</text><rect fill="#E3E3E3" height="31.5592" rx="2.6042" ry="2.6042" style="stroke:#181818;stroke-width:0.5208333333333334;" width="105.2083" x="890.1042" y="29.8177"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="90.625" x="897.3958" y="50.646">Auth-Service</text><rect fill="#E3E3E3" height="31.5592" rx="2.6042" ry="2.6042" style="stroke:#181818;stroke-width:0.5208333333333334;" width="105.2083" x="890.1042" y="665.3971"/><text fill="#000000" font-family="sans-serif" font-size="14.5833" lengthAdjust="spacing" textLength="90.625" x="897.3958" y="686.2254">Auth-Service</text><rect fill="#FFFFFF" height="584.2285" style="stroke:#181818;stroke-width:1.0416666666666667;" width="10.4167" x="79.6875" y="72.8353"/><rect fill="#FFFFFF" height="30.3467" style="stroke:#181818;stroke-width:1.0416666666666667;" width="10.4167" x="580.7292" y="356.0954"/><rect fill="#FFFFFF" height="30.3467" style="stroke:#181818;stroke-width:1.0416666666666667;" width="10.4167" x="784.8958" y="181.5837"/><rect fill="#FFFFFF" height="30.3467" style="stroke:#181818;stroke-width:1.0416666666666667;" width="10.4167" x="784.8958" y="530.6071"/><rect fill="#FFFFFF" height="30.3467" style="stroke:#181818;stroke-width:1.0416666666666667;" width="10.4167" x="937.5" y="94.8486"/><rect fill="#FFFFFF" height="30.3467" style="stroke:#181818;stroke-width:1.0416666666666667;" width="10.4167" x="937.5" y="617.3421"/><polygon fill="#181818" points="925,90.682,935.4167,94.8486,925,99.0153,929.1667,94.8486" style="stroke:#181818;stroke-width:1.0416666666666667;"/><line style="stroke:#181818;stroke-width:1.0416666666666667;" x1="90.1042" x2="931.25" y1="94.8486" y2="94.8486"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.25" x="97.3958" y="89.5716">[01]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="163.5417" x="132.8125" y="89.5716">GET /owner-authenticate</text><polygon fill="#181818" points="101.5625,121.0286,91.1458,125.1953,101.5625,129.362,97.3958,125.1953" style="stroke:#181818;stroke-width:1.0416666666666667;"/><line style="stroke:#181818;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="95.3125" x2="941.6667" y1="125.1953" y2="125.1953"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.25" x="107.8125" y="119.9183">[02]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="423.9583" x="143.2292" y="119.9183">HTTP 302 redirect to idp auth endpoint with (client_id, scope, ...)</text><polygon fill="#181818" points="772.3958,177.417,782.8125,181.5837,772.3958,185.7503,776.5625,181.5837" style="stroke:#181818;stroke-width:1.0416666666666667;"/><line style="stroke:#181818;stroke-width:1.0416666666666667;" x1="90.1042" x2="778.6458" y1="181.5837" y2="181.5837"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.25" x="97.3958" y="176.3067">[03]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="81.25" x="132.8125" y="176.3067">GET redirect</text><polygon fill="#181818" points="101.5625,207.7637,91.1458,211.9303,101.5625,216.097,97.3958,211.9303" style="stroke:#181818;stroke-width:1.0416666666666667;"/><line style="stroke:#181818;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="95.3125" x2="789.0625" y1="211.9303" y2="211.9303"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.25" x="107.8125" y="206.6533">[04]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="279.1667" x="143.2292" y="206.6533">encoded challenge_token &amp; user_consent</text><line style="stroke:#181818;stroke-width:1.0416666666666667;" x1="90.1042" x2="133.8542" y1="268.3187" y2="268.3187"/><line style="stroke:#181818;stroke-width:1.0416666666666667;" x1="133.8542" x2="133.8542" y1="268.3187" y2="281.8604"/><line style="stroke:#181818;stroke-width:1.0416666666666667;" x1="91.1458" x2="133.8542" y1="281.8604" y2="281.8604"/><polygon fill="#181818" points="101.5625,277.6937,91.1458,281.8604,101.5625,286.027,97.3958,281.8604" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.25" x="97.3958" y="263.0417">[05]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="217.7083" x="132.8125" y="263.0417">check challenge_token signature</text><line style="stroke:#181818;stroke-width:1.0416666666666667;" x1="90.1042" x2="133.8542" y1="312.207" y2="312.207"/><line style="stroke:#181818;stroke-width:1.0416666666666667;" x1="133.8542" x2="133.8542" y1="312.207" y2="325.7487"/><line style="stroke:#181818;stroke-width:1.0416666666666667;" x1="91.1458" x2="133.8542" y1="325.7487" y2="325.7487"/><polygon fill="#181818" points="101.5625,321.582,91.1458,325.7487,101.5625,329.9154,97.3958,325.7487" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.25" x="97.3958" y="306.93">[06]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="294.7917" x="132.8125" y="306.93">display user_consent and ask for permission</text><polygon fill="#181818" points="568.2292,351.9287,578.6458,356.0954,568.2292,360.262,572.3958,356.0954" style="stroke:#181818;stroke-width:1.0416666666666667;"/><line style="stroke:#181818;stroke-width:1.0416666666666667;" x1="90.1042" x2="574.4792" y1="356.0954" y2="356.0954"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.25" x="97.3958" y="350.8184">[07]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="233.3333" x="132.8125" y="350.8184">get private Key for AUTH certificate</text><polygon fill="#181818" points="101.5625,382.2754,91.1458,386.4421,101.5625,390.6087,97.3958,386.4421" style="stroke:#181818;stroke-width:1.0416666666666667;"/><line style="stroke:#181818;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="95.3125" x2="584.8958" y1="386.4421" y2="386.4421"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.25" x="107.8125" y="381.1651">[08]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="72.9167" x="143.2292" y="381.1651">private key</text><line style="stroke:#181818;stroke-width:1.0416666666666667;" x1="90.1042" x2="133.8542" y1="416.7887" y2="416.7887"/><line style="stroke:#181818;stroke-width:1.0416666666666667;" x1="133.8542" x2="133.8542" y1="416.7887" y2="430.3304"/><line style="stroke:#181818;stroke-width:1.0416666666666667;" x1="91.1458" x2="133.8542" y1="430.3304" y2="430.3304"/><polygon fill="#181818" points="101.5625,426.1637,91.1458,430.3304,101.5625,434.4971,97.3958,430.3304" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.25" x="97.3958" y="411.5117">[09]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="381.25" x="132.8125" y="411.5117">sign challenge_token with private key from the smartcard</text><line style="stroke:#181818;stroke-width:1.0416666666666667;" x1="90.1042" x2="133.8542" y1="460.6771" y2="460.6771"/><line style="stroke:#181818;stroke-width:1.0416666666666667;" x1="133.8542" x2="133.8542" y1="460.6771" y2="474.2188"/><line style="stroke:#181818;stroke-width:1.0416666666666667;" x1="91.1458" x2="133.8542" y1="474.2188" y2="474.2188"/><polygon fill="#181818" points="101.5625,470.0521,91.1458,474.2188,101.5625,478.3854,97.3958,474.2188" style="stroke:#181818;stroke-width:1.0416666666666667;"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.25" x="97.3958" y="455.4001">[10]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="440.625" x="132.8125" y="455.4001">encrypt signed challenge_token with Puk_IDP_ENC provided by IDP</text><polygon fill="#181818" points="772.3958,526.4404,782.8125,530.6071,772.3958,534.7738,776.5625,530.6071" style="stroke:#181818;stroke-width:1.0416666666666667;"/><line style="stroke:#181818;stroke-width:1.0416666666666667;" x1="90.1042" x2="778.6458" y1="530.6071" y2="530.6071"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.25" x="97.3958" y="525.3301">[11]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="510.4167" x="132.8125" y="525.3301">POST IDP /[authorization_endpoint] with encrypted &amp; signed challenge_token</text><polygon fill="#181818" points="101.5625,556.7871,91.1458,560.9538,101.5625,565.1204,97.3958,560.9538" style="stroke:#181818;stroke-width:1.0416666666666667;"/><line style="stroke:#181818;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="95.3125" x2="789.0625" y1="560.9538" y2="560.9538"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.25" x="107.8125" y="555.6768">[12]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="634.375" x="143.2292" y="555.6768">HTTP 302 redirect to VZD-FHIR Directory /signin-gematik-idp-dienst?code=(authorization_code)</text><polygon fill="#181818" points="925,613.1755,935.4167,617.3421,925,621.5088,929.1667,617.3421" style="stroke:#181818;stroke-width:1.0416666666666667;"/><line style="stroke:#181818;stroke-width:1.0416666666666667;" x1="90.1042" x2="931.25" y1="617.3421" y2="617.3421"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.25" x="97.3958" y="612.0651">[13]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="525" x="132.8125" y="612.0651">GET VZD-FHIR Directory /signin-gematik-idp-dienst?code=(authorization_code)</text><polygon fill="#181818" points="101.5625,643.5221,91.1458,647.6888,101.5625,651.8555,97.3958,647.6888" style="stroke:#181818;stroke-width:1.0416666666666667;"/><line style="stroke:#181818;stroke-width:1.0416666666666667;stroke-dasharray:2.0,2.0;" x1="95.3125" x2="941.6667" y1="647.6888" y2="647.6888"/><text fill="#000000" font-family="sans-serif" font-size="13.5417" font-weight="bold" lengthAdjust="spacing" textLength="31.25" x="107.8125" y="642.4118">[14]</text><text fill="#000000" font-family="sans-serif" font-size="13.5417" lengthAdjust="spacing" textLength="128.125" x="143.2292" y="642.4118">owneraccess-token</text></g></svg>